apiVersion: v1
kind: Service
metadata:
  name: admin
  labels:
    name: admin
spec:
  ports:
    - port: 80
      targetPort: 8080
      protocol: TCP
  selector:
    name: admin
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: admin
  labels:
    name: admin
spec:
  replicas: 1
  selector:
    matchLabels:
      name: admin
  template:
    metadata:
      labels:
        name: admin
    spec:
      imagePullSecrets:
        - name: docker-hub-secret
      containers:
      - image: "index.docker.io/klzii/kliiko:latest"
        imagePullPolicy: Always
        name: admin
        ports:
        - containerPort: 8080
        env:
        - name: REDIS_HOST
          value: "redis-master"
        - name: SERVER_CHAT_DOMAIN_URL
          value: "http://chat.test.klzii.com"
        - name: REDIS_PORT
          value: "6379"
        - name: DATABASE_URL
          value: "postgres://postgres:nWD44LS3bYs29JeP@postgres-master/klzii_test"
        - name: AIRBRAKE_PROJECT_ID
          value: "121542"
        - name: AIRBRAKE_API_KEY
          value: "607e87c9e8b7500497bb84c51162b0a82"
        - name: SERVER_BASE_DOMAIN
          value: ".test.klzii.com"
        - name: SERVER_DOMAIN
          value: "www.test.klzii.com"
        - name: SERVER_BASE_SUBDOMAIN
          value: "www"
        - name: SERVER_SKIP_SUBDOMAINS
          value: "www,test"
