<div class='row'>
  <div class='dashboard-container'>
    <div class='col-xs-12'>
      <div>
        <h2 class='text-center'>
          Chat Sessions
        </h2>
      </div>
      <div class='text-right'>
        <button id='dashboard-build-new-session'class='btn btn-addNewElement btn-green' ui-sref="dashboard.chatSessions.builder">Build New Session</button>
      </div>
    </div>
    <div class='col-xs-12 fixed-bottom-margin'>
      <table class='table table-dashboardElements'>
        <thead>
          <tr class='background-green'>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.orderByField='name'; csc.reverseSort = !csc.reverseSort">
                Name
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.orderByField='facilitator.username'; csc.reverseSort = !csc.reverseSort">
                Facilitator
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.orderByField='startTime'; csc.reverseSort = !csc.reverseSort">
                Start Date
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.orderByField='endTime'; csc.reverseSort = !csc.reverseSort">
                End Date
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.orderByField='expireDate'; csc.reverseSort = !csc.reverseSort">
                Expiration Date
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.orderByField='showStatus'; csc.reverseSort = !csc.reverseSort">
                Status
              </a>
            </th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr class='{{ csc.rowClass(session) }}' ng-repeat='session in csc.sessions | orderBy:csc.orderByField:csc.reverseSort'>
            <td>{{ session.name }}</td>
            <td>{{ session.facilitator.username }}</td>
            <td>{{ session.startTime | date:sc.dateFormat }}</td>
            <td>{{ session.endTime | date:sc.dateFormat }}</td>
            <td>{{ session.expireDate | date:sc.dateFormat }}</td>
            <td>{{ session.showStatus }}</td>
            <td class='text-right dashboardElementsEditRemove'>

              <span id='dashboard-session-rating' uib-popover-template="'averageRating.html'" popover-trigger='mouseenter' class='glyphicon glyphicon-star' aria-hidden='true' ng-if='csc.hasAccess(session.id, app.accountUser)' ng-click='csc.changePage("sessionRating", session)'></span>
              <img id='dashboard-copy-session' src='/icons/resources_grey.png' alt='' ng-click='csc.copySession(session)' ng-if='csc.hasAccess(session.id, app.accountUser)'/>
              <img id='dashboard-edit-session' src='/icons/dashboardElement_edit.png' alt='' ng-if='csc.hasAccess(session.id, app.accountUser)' ui-sref="dashboard.chatSessions.builder({id:session.id})" ng-click=""/>
              <img src='/icons/dashboardElement_remove.png' alt='' ng-click='csc.removeSession(session)' ng-if='csc.hasAccess(session.id, app.accountUser)'/>

              <div style="display:inline-block;" ng-if="csc.isMember(session.facilitator.AccountUser.email, session.SessionMembers, app.user)">
                <span id="dashboard-enter-chat-room" class='glyphicon glyphicon-play' aria-hidden='true' ng-click='csc.redirectToChatSession(session.id)' ng-if='!csc.isExpired(session) && app.account.isActiveSubscription'></span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script type='text/ng-template' id='averageRating.html'>
  <div>
    <uib-rating class='session-rating-stars text-vertical-middle no-pointer-events' ng-model='session.averageRating' max='5' aria-labelledby='default-rating' readonly='true' tabindex=''>
    </uib-rating>
  </div>
</script>
