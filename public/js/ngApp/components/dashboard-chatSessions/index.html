<div class='row'>
  <div class='dashboard-container'>
    <div class='col-xs-12'>
      <div>
        <h2 class='text-center'>
          Chat Sessions
        </h2>
      </div>
      <div class='text-right'>
        <button ng-if='!app.accountUser.isFacilitator' id='dashboard-build-new-session'class='btn btn-standart btn-margin btn-green btn-large' ui-sref="account-hub.chatSessions.builder" messages-directive='skip'>Build New Session</button>
      </div>
    </div>

    <div class='col-xs-12'>
      <table class='table table-dashboardElements'>
        <thead>
          <tr class='background-green'>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.changeOrder('name')">
                Name
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.changeOrder('type')">
                Type
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.changeOrder('facilitator.username')">
                Facilitator
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.changeOrder('startTime')">
                Start Date
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.changeOrder('endTime')">
                End Date
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.changeOrder('expireDate')">
                Expiration Date
              </a>
            </th>
            <th>
              <a class="white-sort-text" href="" ng-click="csc.changeOrder('showStatus')">
                Status
              </a>
            </th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr class='{{ csc.rowClass(session) }}' ng-repeat='session in csc.sessions | orderBy:csc.orderByField'>
            <td>
              {{ session.name }}
              <i ng-if='session.name == ""'>untitled</i>
            </td>
            <td class="capitalize">{{ session.type }}</td>
            <td>{{ session.facilitator.AccountUser.firstName }} {{ session.facilitator.AccountUser.lastName }}</td>
            <td>{{ session.startTime | date:sc.dateFormat }}</td>
            <td>{{ session.endTime | date:sc.dateFormat }}</td>
            <td>{{ session.expireDate | date:sc.dateFormat }}</td>
            <td>{{ session.showStatus }}</td>
            <td class='text-right col-xs-3'>

              <span id='dashboard-session-rating' uib-popover-template="'averageRating.html'" popover-trigger='mouseenter' class='glyphicon glyphicon-star' aria-hidden='true' ng-if='csc.hasAccess(session.id, app.accountUser)' ng-click='csc.changePage("sessionRating", session)'></span>
              <img id='dashboard-copy-session' src='/icons/resources_grey.png' alt='' ng-click='csc.copySession(session)' ng-if='csc.hasAccess(session.id, app.accountUser)'/>
              <img id='dashboard-edit-session' src='/icons/dashboardElement_edit.png' alt='' ng-if='csc.hasAccess(session.id, app.accountUser)' ui-sref="account-hub.chatSessions.builder({id:session.id})" ng-click=""/>
              <img src='/icons/dashboardElement_remove.png' alt='' ng-click='csc.removeSession(session)' ng-if='csc.hasAccess(session.id, app.accountUser)'/>

              <span id="dashboard-enter-chat-room" class='glyphicon glyphicon-play' aria-hidden='true' ng-click='csc.redirectToChatSession(session.id)'></span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class='col-xs-12 build-session-text' ng-if='csc.queriedForSessions && !csc.sessions.length'>
      <h2 class='text-center'>Build a new Session to get started</h2>
    </div>

    <div class='col-xs-12 fixed-bottom-margin'></div>
  </div>
</div>

<script type='text/ng-template' id='averageRating.html'>
  <div>
    <uib-rating class='session-rating-stars text-vertical-middle no-pointer-events' ng-model='session.averageRating' max='5' aria-labelledby='default-rating' readonly='true' tabindex=''>
    </uib-rating>
  </div>
</script>
