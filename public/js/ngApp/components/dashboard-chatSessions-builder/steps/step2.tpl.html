<section ng-controller='TopicsController as tc'>
  <section ng-controller="SessionStep2Controller as step2Controller" ng-init="step2Controller.init(tc.list)">
    <section id="step-2" class="animated fadeIn">
      <h3 class="text-center">Topics</h3>

      <div class="row margin-bottom-20" id='resources-topics'>
        <div class="col-md-12 text-center" ng-if="!tc.list.length">
          There are no topics yet
          <div id="create-new-btn" class="btn btn-standart btn-green btn-large" ng-click="tc.openModal('new')">
            Create New Topic
          </div>
        </div>

        <div class="col-md-6" ng-if="tc.list.length">
          <h3>Select topic</h3>
          <div class="flex">
            <div class="check">
              <input id="select-all-topics" ng-click="step2Controller.selectAllTopics()" class="kliiko-checkbox checkbox-btn btn-green" type="checkbox" ng-checked="step2Controller.allTopicsSelected">
              <label for="select-all-topics"></label> Select all
            </div>
            <div id="create-new-btn" class="btn btn-standart btn-green btn-large text-left pull-right" ng-click="tc.openModal('new')">
              Create New Topic
            </div>
          </div>

          <div id="topics-list" class='margin-top-20'>
            <div class="topic-list-item" ng-repeat="topic in tc.list" ng-drag="step2Controller.canDragElement(topic)" ng-drag-success="step2Controller.topicsOnDropComplete(topic)">
              <div class="check">
                <input id="memberSelectet{{ $index }}" class="kliiko-checkbox checkbox-btn btn-green" ng-checked="topic._selected" ng-click="topic._selected = !topic._selected" type="checkbox">
                <label for="memberSelectet{{ $index }}" class="kliiko-checkbox"></label>
              </div>

              {{ topic.name }}
              <img ng-drag="false" class="pull-right ic" ng-click="tc.deleteTopic(topic.id)" src="/icons/dashboardElement_remove.png" title="Delete">
              <img ng-drag="false" class="pull-right ic" src="/icons/dashboardElement_edit.png" title="Edit" ng-click="tc.openModal('edit', topic)">
            </div>
          </div>
        </div>

        <div class="col-md-6" ng-if="tc.list.length">
          <h3>Chat Session topics</h3>
          <div class="drop-area" ng-drop="true">Drop Selected Topics Here</div>

          <div class="margin-top-10" ui-sortable="step2Controller.sortableOptionsA" ng-model="step2Controller.sessionTopicsArray">
            <div class="topic-list-item" ng-repeat="topic in step2Controller.sessionTopicsArray">
              <span>
                <img src="/icons/ic_move.png">
                <input type="radio" ng-model="topic.sessionTopic.landing" ng-value="true" ng-change='step2Controller.changeLandingState(topic)' ng-disabled="!topic.sessionTopic.active">
                {{ topic.sessionTopic.name }}
              </span>

              <img class="pull-right ic" ng-click="step2Controller.removeTopicFromList(topic.sessionTopic.id)" src="/icons/dashboardElement_remove.png" title="Delete">
              <img class="pull-right ic" src="/icons/dashboardElement_edit.png" title="Edit" ng-click="step2Controller.openModal('sessionTopic', topic)">
              <img class="pull-right ic" ng-if="topic.sessionTopic.active" src="/icons/unlocked.png" ng-click="step2Controller.changeActiveState(topic)" title="Active">
              <img class="pull-right ic" ng-if="!topic.sessionTopic.active" src="/icons/locked.png" ng-click="step2Controller.changeActiveState(topic)" title="Not Active">
            </div>
          </div>
        </div>

        <ng-include ng-init="topics = tc" src="'/js/ngApp/components/dashboard-resources-topics/topicsModals.html'"></ng-include>
      </div>
    </section>
  </section>
</section>
