<section class="global-wrapper" ng-controller='TopicsController as topics'>
    <section id="step-2" class="animated fadeIn" >

        <h3 class="text-center">Facilitator And Topics</h3>

        <uib-accordion close-others="false">
            <uib-accordion-group is-open="sbc.accordions.facilitators">
                <uib-accordion-heading>
                    <div class="panel-label">
                        Select Facilitator
                        <i class="pull-right glyphicon"
                           ng-class="{'glyphicon-chevron-down': sbc.accordions.sessionName, 'glyphicon-chevron-right': !sbc.accordions.sessionName}"></i>
                        <span class="panel-value pull-right">{{ sbc.selectedFacilitator.lastName + ' ' + sbc.selectedFacilitator.firstName}}</span>
                    </div>
                </uib-accordion-heading>

                <!--<div class="text-center">
                    <div class="btn-standart btn-green" ng-click="sbc.selectFacilitatorsClickHandle()">
                        Select Facilitator From Contact List &nbsp;<img src="/icons/account_manager_green.png">
                    </div>
                </div>-->

                <div ng-show="sbc.selectedFacilitator" class="btn-standart btn-red"
                     ng-click="sbc.selectedFacilitator = null">
                    Clear Selection
                </div>

                <div id='dashboard-contact-lists' ng-controller="ContactListController as clc" ng-init="clc.initLists()">
                    {{ clc.sectListActiveToFacilitators() }}
                    <div class="row">
                        <div id="contact-lists-right-column" class="col-md-12">
                            <!-- TABLE -->
                            <section id="dashboard-contact-lists-main-table">
                                <table class='table table-responsive table-dashboardElements'
                                       ng-hide="!clc.lists.activeList.members.length" style="font-size: 1.6rem">
                                    <thead>
                                    <tr>
                                        <th class="selection-column"></th>
                                        <th class="th-header druggable"
                                            ng-repeat="rowHeader in clc.lists.activeList.visibleFields track by $index"
                                            ng-click="clc.changeTableSortingFilter(rowHeader)"
                                            ng-drag="true" ng-drag-data="$index">
                                        <span class="sorting-order-arrow"><i class="glyphicon glyphicon-triangle-top"
                                                                             ng-show="clc.tableSort.by == rowHeader && clc.tableSort.reverse"></i></span>
                                        <span class="sorting-order-arrow"><i class="glyphicon glyphicon-triangle-bottom"
                                                                             ng-show="clc.tableSort.by == rowHeader && !clc.tableSort.reverse"></i></span>
                                        <span class="th-name" ng-drop="true"
                                              ng-drop-success="clc.updateTableSorting($data,$index)">{{rowHeader | human2Camel : true}}</span>

                                        </th>

                                        <th ng-click="clc.showManageColumnsModal()">
                                            <img ng-click="sbc.faderHack()"  src="/icons/grid.png">
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr class="member-row"
                                        ng-repeat='member in clc.lists.listByType["Facilitators"].members | orderBy: clc.tableSort.by : clc.tableSort.reverse'
                                        ng-class="{'selected':member._selected}">
                                        <td class="selection-column">
                                            <input type="radio" ng-value="member" ng-model="sbc.selectedFacilitator">
                                            <!--<div class="check">-->
                                            <!--<input id="memberSelectet{{ $index }}" class="kliiko-checkbox checkbox-btn btn-green" ng-model="member._selected" ng-click="member.selected = !member.selected" type="checkbox" >-->
                                            <!--<label for="memberSelectet{{ $index }}" class="kliiko-checkbox" ></label>-->
                                            <!--</div>-->
                                        </td>

                                        <td ng-repeat="tableRow in clc.lists.activeList.visibleFields track by $index"> {{
                                            member[tableRow] || '-' }}
                                        </td>

                                        <td>
                                            <span class='table-item-edit-group'>
                                              <!--<img src='/icons/dashboardElement_edit.png' alt='' ng-click="clc.contactAddEditClickHandle('update', member)"/>-->
                                                <!--<img src='/icons/dashboardElement_remove.png' alt='' ng-click="clc.removeContacts(member.id)" />-->
                                            </span>
                                        </td>
                                    </tr>

                                    </tbody>
                                </table>
                            </section>
                            <!--eof table-->

                            <div id="no-contacts-in-list" class="text-center"
                                 ng-show="!clc.lists.activeList.members.length">
                                <h3>There is no contacts in this list yet</h3>

                                <!--<div custom-select-directive data-title="Add Contacts" data-id="contact-lists-add-button-2"-->
                                     <!--class="custom-select-directive">-->
                                    <!--<li ng-click="clc.contactAddEditClickHandle('new')"><a href=""><i-->
                                            <!--class="icon-remove"></i>Manual Input</a></li>-->
                                    <!--<li ng-click="clc.contactAddEditClickHandle('excel')"><a href=""><i-->
                                            <!--class="icon-remove"></i>Import Excel</a></li>-->
                                    <!--<li ng-click="clc.contactAddEditClickHandle('csv')"><a href=""><i-->
                                            <!--class="icon-remove"></i>Import CSV</a></li>-->
                                <!--</div>-->

                            </div>
                        </div>
                    </div>

                    <!-- MODALS -->
                    <!-- Manage columns view -->
                    <div id="contactList-manageColumns" class="modal fade" role="dialog">
                        <div class="modal-dialog contactDetailsModal" style="width: 800px">
                            <div class="modal-content border-green border-radius-none">
                                <div class='modal-header'>
                                    <button type='button' class='close' data-dismiss="modal">&times;</button>
                                    <h2 class='modal-title text-center'>Manage Columns in View</h2>
                                </div>
                                <div class='modal-body text-gray-medium'>
                                    <form class='form-horizontal' role='form'>

                                        <!------------------------------------------>

                                        <uib-accordion close-others="false">
                                            <uib-accordion-group is-open="clc.modContentBlock.generalDetails">
                                                <uib-accordion-heading>
                                                    <div class="panel-label">
                                                        General Details<i class="pull-right glyphicon"
                                                                          ng-class="{'glyphicon-chevron-down': clc.modContentBlock.generalDetails, 'glyphicon-chevron-right': !clc.modContentBlock.generalDetails}"></i>
                                                    </div>
                                                </uib-accordion-heading>
                                            <span class="row">
                                              <span class="col-md-3"
                                                    ng-repeat="column in clc.lists.activeList.availableTables() track by $index">
                                                <div class="check fields-to-show">
                                                    <input id="dashboard-contact-lists-fields-{{ $index }}"
                                                           ng-click="clc.lists.activeList.toggleTableToShow(column)"
                                                           class="kliiko-checkbox checkbox-btn btn-green"
                                                           ng-model="clc.selectedTables[column]" type="checkbox">
                                                    <label for="dashboard-contact-lists-fields-{{ $index }}"></label>{{
                                                    column }}
                                                </div>

                                              </span>
                                            </span>

                                            </uib-accordion-group>


                                            <uib-accordion-group is-open="clc.modContentBlock.history">
                                                <uib-accordion-heading>
                                                    <div class="panel-label">
                                                        Participant Invitation History <i class="pull-right glyphicon"
                                                                                          ng-class="{'glyphicon-chevron-down': clc.modContentBlock.history, 'glyphicon-chevron-right': !clc.modContentBlock.history}"></i>
                                                    </div>
                                                </uib-accordion-heading>

                                            <span class="row">
                                              <span class="col-md-3"
                                                    ng-repeat="column in clc.lists.activeList.participantsFields">
                                                <div class="check fields-to-show">
                                                    <input id="dashboard-contact-lists-participants-{{ $index }}"
                                                           ng-click="clc.lists.activeList.toggleTableToShow(column)"
                                                           class="kliiko-checkbox checkbox-btn btn-green"
                                                           ng-model="clc.selectedTables[column]" type="checkbox">
                                                    <label for="dashboard-contact-lists-participants-{{ $index }}"></label>{{
                                                    column }}
                                                </div>

                                              </span>
                                            </span>

                                            </uib-accordion-group>
                                        </uib-accordion>

                                        <!------------------------------------------>

                                        <div class='row'>
                                            <div class='col-md-12'>
                                                <div class='btn-standart btn-green pull-right' data-dismiss="modal">Done
                                                </div>

                                            </div>
                                        </div>

                                    </form>
                                </div>

                            </div>
                        </div>
                    </div>


                </div>


            </uib-accordion-group>

            <uib-accordion-group is-open="sbc.accordions.topics">
                <uib-accordion-heading>
                    <div class="panel-label">
                        Select Topics And Session Topics <i class="pull-right glyphicon"
                                                            ng-class="{'glyphicon-chevron-down': sbc.accordions.brandLogo, 'glyphicon-chevron-right': !sbc.accordions.brandLogo}"></i>
                        <span class="panel-value pull-right">{{ sbc.brandLogo.JSON.name }}</span>
                    </div>
                </uib-accordion-heading>

                <div class="row" id='resources-topics' >
                    <div class="col-md-6">
                        <h3>Select topic</h3>
                        <div  ng-hide="!topics.list.length">
                            <div class="btn-standart btn-green" ng-click="topics.createNew()">
                                Create New Topic&nbsp;<img src="icons/add_new_list_green.png" alt="">
                            </div>
                        </div>
                        <br>
                        <div class='dashboard-container'>
                            <div id="topics-list">


                                <div class="topic-list-item" ng-repeat="t in topics.list"
                                     ng-drag="true" ng-drag-data="t" ng-drag-success="sbc.topicsOnDropComplete($data,$event)">
                                    <div class="panel-label">
                                        <span ng-if="topics.editBlockHelper != $index">
                                            {{t.name}}
                                        </span>
                                        <span ng-if="topics.editBlockHelper == $index">
                                            <input type="text" ng-model="t.name"
                                                   maxlength="{{ ::topics.nameMaxSize}}"
                                                   ng-blur="topics.saveInline($index, t.name)">
                                            <span class="inline-editor-help">Characters left: {{ topics.nameMaxSize - t.name.length }}</span>
                                        </span>
                                    </div>
                                    <div class="control-block">
                                            <span id="edit-block-{{ $index }}" class="edit-block animated slideInRight"
                                                  style="display: none">
                                                <img src="/icons/ic_edit.png" alt="" title="Rename" ng-click="topics.edit($index)">
                                            </span>
                                        <img class="pull-right ic" ng-click="topics.deleteTopic(t.id)"
                                             src="/icons/dashboardElement_remove.png" alt="" title="Delete">
                                        <img class="pull-right ic" src="/icons/dashboardElement_edit.png" alt=""
                                             title="Edit" ng-click="topics.toggleEditBlock($index)">
                                    </div>

                                </div>

                            </div>

                        </div>


                    </div>
                    <div class="col-md-6">
                        <h3>Chat Session topics</h3>
                        <div>
                            <div class="drop-area" ng-drop="true">Drop Topics Here </div>
                            <br>

                            <div class="topic-list-item" ng-repeat="t in sbc.chatSessionTopicsList | orderBy:'topic_order_id' "  ng-drag="true" ng-drag-data="t">
                                <div class="panel-label" ng-drop="true" ng-drop-success="sbc.reorderTopics($data, t)">
                                <span ng-if="topics.editBlockHelper != $index">
                                    {{t.name}}
                                </span>
                                <span ng-if="topics.editBlockHelper == $index">
                                    <input type="text" ng-model="t.name"
                                           maxlength="{{ ::topics.nameMaxSize}}"
                                           ng-blur="topics.saveInline($index, t.name)">
                                    <span class="inline-editor-help">Characters left: {{ topics.nameMaxSize - t.name.length }}</span>
                                </span>
                                </div>

                                <div class="control-block">
                                <span id="edit-block-{{ $index+'ts' }}" class="edit-block animated slideInRight"
                                      style="display: none">
                                    <img src="/icons/ic_edit.png" alt="" title="Rename" ng-click="topics.edit($index)">
                                </span>
                                    <img class="pull-right ic" ng-click="sbc.removeTopicFromList(t.id)"
                                         src="/icons/dashboardElement_remove.png" alt="" title="Delete">
                                    <img class="pull-right ic" src="/icons/dashboardElement_edit.png" alt=""
                                         title="Edit" ng-click="topics.toggleEditBlock($index+'ts')">
                                </div>

                            </div>

                        </div>
                    </div>
                </div>
            </uib-accordion-group>

        </uib-accordion>



    </section>


    <!----------- MODALS ---------------------->
    <section>
        <!--------- Modals --------->

        <section>
            <!-- plansModal -->
            <div class='modal fade' id='createNewTopic' role='dialog'>
                <div class='modal-dialog changePasswordModal' style="width: 800px">
                    <div class='modal-content border-green border-radius-none'>
                        <div class='modal-header'>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h1 class='modal-title text-center'>Create New Topic</h1>
                        </div>
                        <div class='modal-body'>

                            <form ng-submit="topics.validateNewAndAdd()">
                                <div class="row">
                                    <div class="text-center">
                                        <input id="new-topic-input" type="text" maxlength="15"
                                               ng-model="topics.newTopicName">
                                        <br>
                                        <div id="new-topic-input-help">
                                            Characters left: {{ topics.nameMaxSize -
                                            topics.newTopicName.length }}
                                        </div>
                                    </div>


                                </div>
                            </form>

                        </div>
                        <div class='modal-footer'>
                            <div type='button' class='pull-left btn-standart btn-red'
                                 data-dismiss='modal'>
                                Cancel
                            </div>

                            <div type='submit' class='pull-right btn-standart btn-green'
                                 ng-click="topics.validateNewAndAdd()">Create
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </section>
</section>
