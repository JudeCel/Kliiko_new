<section id='GalleryController' ng-controller='GalleryController'>
  <form ng-submit="submitIdsForMassAction(action)">
    <div class="gallery col-md-12">
      <div class="dashboard-container">
        <div class="row">
          <div class="col-md-4">
            <div class="col-md-6 margin-25-top-bottom">
              <input id="selectall" ng-click="selectAllResources()" name="selectAll" type="checkbox" value="selectAll" />
              <label for="selectAll">Select All</label>
            </div>
            <button type='submit' ng-disabled="idsForAction == 0" 
                    class='btn btn-addNewElement btn-green' 
                    ng-click="actionDelete('delete')">
              <span class='glyphicon glyphicon-remove' aria-hidden='true'></span>   
            </button>

            <button type='submit' ng-disabled="idsForAction == 0" 
                    class='btn btn-addNewElement btn-green' 
                    ng-click="actionDownload('download')">
              <span class='glyphicon glyphicon-download-alt' aria-hidden='true'></span>   
            </button>
          </div>
          
          <div class="col-md-4">
            <h2 class="text-center">Gallery</h2>
            <h4 class="text-center has-error text-red-dark ng-binding"></h4>
            <h4 class="text-center ng-binding"></h4>
          </div>
          
          <div class="col-md-4 text-right">
            <button class="btn btn-addNewElement btn-green" type='button' ng-click="setView('panel')" ng-if="viewType == 'table'">
              <span class='glyphicon glyphicon-th' aria-hidden='true'></span>   
            </button>

            <button class="btn btn-addNewElement btn-green" type='button' ng-click="setView('table')" ng-if="viewType == 'panel'">
              <span class='glyphicon glyphicon-th-list' aria-hidden='true'></span>   
            </button>

            <button class='btn btn-addNewElement btn-green' type='button' id='uploadResourceDropdown' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>
              <span class='glyphicon glyphicon-plus' aria-hidden='true'></span>
              Add New Resource
            </button>
            <ul class='pull-right dropdown-menu header-dropdown-ul' aria-labelledby='uploadResourceDropdown'>
              <li class='text-right text-size-dashboard'>
                <a ng-click="uploadResourceForm('image')" data-toggle='modal' >
                  Upload Image
                </a>
              </li>

              <li class='text-right text-size-dashboard'>href=''
                <a ng-click="uploadResourceForm('brandLogo')" data-toggle='modal' >
                  Upload Brand Logo
                </a>
              </li>

              <li class='text-right text-size-dashboard'>
                <a ng-click="uploadResourceForm('audio')" data-toggle='modal' href=''>
                  Upload Audio
                </a>
              </li>

              <li class='text-right text-size-dashboard'>
                <a ng-click="uploadResourceForm('pdf')" data-toggle='modal' href=''>
                  Upload PDF
                </a>
              </li>

              <li class='text-right text-size-dashboard'>
                <a ng-click="uploadResourceForm('youtubeUrl')" data-toggle='modal' href=''>
                  Save Youtube URL
                </a>
              </li>

            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="gallery col-md-12">
      <div class='col-md-12 category-selection'>
        <a class="green-link" ng-click="filterBy('')">All({{getCount("")}})</a>
        <a class="green-link" ng-click="filterBy('image')">Images({{getCount("image")}})</a>
        <a class="green-link" ng-click="filterBy('video')">Video({{getCount("video")}})</a>
        <a class="green-link" ng-click="filterBy('pdf')">PDF({{getCount("pdf")}})</a>
        <a class="green-link" ng-click="filterBy('audio')">Audio({{getCount("audio")}})</a>
        <a class="green-link" ng-click="filterBy('brandLogo')">Brand Logo({{getCount("brandLogo")}})</a>
      </div>

    <!-- Table view -->
      <div class="gallery-body col-md-12" ng-if="viewType == 'table'">
        <table class="table table-responsive table-dashboardElements" > 
          <thead>
            <tr class='green-background'>
              <th>#</th>
              <th></th>
              <th>Title</th>
              <th>Format</th>
              <th></th>
            </tr>
          </thead>
          <tbody ng-repeat="resource in resources">
            <tr ng-if="resource.resourceType != 'tmp'" class="ng-scope">
              <td class="ng-binding">
                <input class='pull-left' type="checkbox" 
                       value="{{resource.id}}" ng-click="resourcesSelected(resource.id)"
                       ng-checked="resource.checked" ng-model="resource.checked"/>
              </td>
              <td class="ng-binding" ng-if="resource.JSON.type == 'video'">
                <img src="/chat_room/resources/images/youtubeThumb.png" alt="youtube" image-resize image-percent="50" width="100" height="100" class="img-responsive">
              </td>
              <td class="ng-binding" ng-if="resource.JSON.type == 'image' || resource.JSON.type == 'brandLogo'">
                <img src="/chat_room/uploads/{{resource.JSON.tableThumb}}"/>
              </td>
              <td class="ng-binding" ng-if="resource.JSON.type == 'audio'">
                <img src="/chat_room/resources/images/audioThumb.png" alt="audio" image-resize image-percent="50" width="100" height="100" class="img-responsive">
              </td>
              <td class="ng-binding" ng-if="resource.JSON.type == 'pdf'">
                <img src="/chat_room/uploads/pdf.png" alt="audio" image-resize image-percent="50" width="100" height="100" class="img-responsive">
              </td>
              <td class="ng-binding">
                <p class="pull-left">
                  {{ resource.JSON.title }}
                  </p>
              </td>
              <td>
                <p>{{ resource.JSON.format }}</p>
                <a ng-if="resource.JSON.type == 'video'" href="{{ resource.JSON.url }}" target="_blank">{{ resource.JSON.url }}</a>
              </td>
              <td>
                <button type='submit'
                        class='btn btn-addNewElement btn-green' 
                        ng-click="deleteResources(resource.id)">
                  <span class='glyphicon glyphicon-remove' aria-hidden='true'></span>   
                </button>

                <a type='submit' download="{{resource.JSON.matchName}}"
                        class='btn btn-addNewElement btn-green' 
                        href="{{'/chat_room/uploads/' + resource.JSON.name}}">
                  <span class='glyphicon glyphicon-download-alt' aria-hidden='true'></span>   
                </a>
              </td>

            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- Panel view -->
      <div ng-if="viewType == 'panel'" ng-repeat="resource in resources | filter: { resourceType: filterType }">
        <div class="col-xs-2 col-md-4" ng-if="resource.resourceType != 'tmp'">  
          <div class="panel panel-success border-green">
            <div class="panel-body panel-min-size">
              
              <div ng-bind-html="renderHtml(resource.JSON.message)" ng-if="resource.JSON.type == 'video'"></div>
              
              <div class="responsive-container" ng-if="resource.JSON.type == 'image' || resource.JSON.type == 'brandLogo'">
                  <div class="dummy"></div>

                  <div class="img-container">
                      <img src="/chat_room/uploads/{{resource.JSON.panelThumb}}" class="center-block vertical-align"/>
                  </div>
              </div>
            
              <div class="responsive-container" ng-if="resource.JSON.type == 'audio'">
                <div class="dummy"></div>

                <div class="img-container">
                  <img src="/chat_room/resources/images/audioThumb.png" alt="{{resource.JSON.matchName}}" image-resize image-percent="50" width="315" height="315" class="img-responsive center-block" >
                </div>
                
              </div>

              <div class="responsive-container" ng-if="resource.JSON.type == 'pdf'">
                <div class="dummy"></div>

                <div class="img-container">
                  <img src="/chat_room/uploads/pdf.png" alt="{{resource.JSON.matchName}}" image-resize image-percent="50" width="" height="" class="img-responsive center-block" >
                </div>
              </div>

            </div>

            <div class="panel-footer">
              <input class='pull-left col-md-1' type="checkbox" 
                     value="{{resource.id}}" ng-click="resourcesSelected(resource.id)"
                     ng-checked="resource.checked" ng-model="resource.checked"/>

              {{ resource.JSON.title }}

              <div class='pull-right col-md-2'>
                {{ resource.JSON.format }}
                <a ng-if="resource.JSON.type == 'video'" href="{{ resource.JSON.url }}" target="_blank" class="green-text">link</a>
              </div>
            </div>
        </div>
      </div> 
    </div>
  </form>

  <!-- resourceModal -->
  <div class='modal fade' id='uploadTST' role='dialog'>
    <div class='modal-dialog changePasswordModal' >
      <div class='modal-content border-green border-radius-none'>
        <div class='modal-header'>
          <button type='button' class='close' data-dismiss='modal'>&times;</button>
          <h2 class='modal-title text-center'>New {{ uploadTypeForTitle }} resource.</h2>
        </div>
        <form ng-submit="submitForm(newResource)">
          <div class='modal-body'>

            <div class="form-group">
              <label for="title">Title</label>
              <input ng-model="newResource.title" type="text" class="form-control center-block" name="title" id="title" placeholder="Title">
            </div>

            <div ng-if="newResource.type == 'youtubeUrl'" class="form-group">
              <label for="youtubeUrl">Youtube Url</label>
              <input ng-model="newResource.youtubeUrl" type="text" class="form-control center-block" name="youtubeUrl" id="youtubeUrl" placeholder="Youtube URL">
            </div>

            <div ng-if="newResource.type !== 'youtubeUrl'" class="form-group">
              <label for="fileTst">File</label>
              <div ngf-drop ngf-select ng-model="newResource.fileTst" ng-change="uploadTst()" class="drop-box"
                ngf-drag-over-class="'dragover'" >
                Drop images here or click to upload</div>
              <div ngf-no-file-drop >File Drag/Drop is not supported for this browser</div>
              {{ newResource.fileTst.name }}
            </div> 
          </div>
          <div class='modal-footer'>
            <div type='button' class='pull-left btn-dashboard-plans go-back-btn' data-dismiss='modal'>Cancel</div>
            <input type='submit' class='pull-right btn-dashboard-plans btn'>
          </div>
        </form>   
      </div>
    </div>
  </div>
</section>
